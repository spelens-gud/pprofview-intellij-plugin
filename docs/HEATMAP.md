# 热力图功能说明

## 概述

热力图使用矩形树图（Treemap）的形式展示 Top 20 函数的性能分布，提供直观的可视化效果。

## 特点

### 1. 矩形面积
- 矩形的大小代表函数的性能占比
- 占比越大，矩形越大
- 显示 Top 20 个函数

### 2. 颜色深浅
- 颜色深浅代表热点程度
- 深色：高热点（性能占比大）
- 浅色：低热点（性能占比小）
- 使用渐变效果，更加美观

### 3. 显示内容
- **大矩形**（宽 > 80px，高 > 40px）：
  - 排名（#1, #2, ...）
  - 性能占比百分比
  - 函数名（截断显示）

- **中等矩形**（宽 > 40px，高 > 30px）：
  - 排名

- **小矩形**：
  - 仅显示颜色

### 4. 交互功能
- **悬停**：显示详细信息工具提示
  - 函数名
  - Flat 和 Cum 数据
  - 性能占比
  
- **点击**：跳转到代码位置
  - 自动打开源文件
  - 高亮热点行
  - 显示性能数据 inlay hints

## 布局算法

使用简化的网格布局算法：
1. 计算网格行列数（基于条目数量）
2. 根据性能占比调整矩形大小
3. 保持整体布局的规整性

## 视觉效果

- 圆角矩形（8px 圆角）
- 阴影效果
- 渐变填充
- 白色文字（高对比度）
- 深色边框

## 使用场景

热力图特别适合：
1. 快速识别性能瓶颈
2. 对比多个函数的性能占比
3. 发现性能分布模式
4. 直观展示性能热点

## 与其他视图的对比

| 视图 | 优势 | 适用场景 |
|------|------|----------|
| 详细数据 | 精确数据，可排序 | 需要精确数值 |
| 柱状图 | 清晰对比 | 对比 Top N 函数 |
| 饼图 | 占比关系 | 查看整体分布 |
| 热力图 | 直观视觉 | 快速识别热点 |

## 示例

```
┌─────────────────────────────────────┐
│     Top 20 函数热力图                │
│  矩形面积 = 性能占比 | 颜色深浅 = 热点程度  │
├─────────────────────────────────────┤
│  ┌──────┐ ┌────┐ ┌─────┐           │
│  │  #1  │ │ #2 │ │ #3  │           │
│  │45.2% │ │20% │ │15.3%│           │
│  │main  │ │foo │ │bar  │           │
│  └──────┘ └────┘ └─────┘           │
│  ┌────┐ ┌───┐ ┌───┐ ┌──┐          │
│  │ #4 │ │#5 │ │#6 │ │#7│          │
│  │8.5%│ │5% │ │3% │ │2%│          │
│  └────┘ └───┘ └───┘ └──┘          │
│  ... 更多矩形 ...                   │
└─────────────────────────────────────┘
```

## 技术实现

- 使用 Swing 自定义绘制
- Graphics2D 渲染
- 鼠标事件处理
- 动态布局计算
- 颜色渐变算法
